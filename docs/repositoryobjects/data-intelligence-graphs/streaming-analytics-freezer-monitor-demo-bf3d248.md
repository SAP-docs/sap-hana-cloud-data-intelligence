<!-- loiobf3d248139b143a2a80e3bb44f90dc11 -->

# Streaming Analytics Freezer Monitor Demo

This is an example of a more complex graph involving streaming analytics operators. In this demo, multiple streaming analytics operators interact to generate and process events such as power alarms and outages, and temperature readings and alarms from a fictional freezer monitor.



## Prerequisites

Several streaming analytics operators in this example require a connection called HANA\_DB1 of type HANA\_DB. Define this connection in the Connection Manager and make sure that this connection is configured to point at your SAP HANA tenant database. If you use a different connection name than HANA\_DB1, you'll need to update the *hana services* properties in all the affected operators and select your connection name from the drop-down list. Additionally, if you change the connection name, you'll also need to update the *service* property in the CCL of each of the affected operators.



<a name="loiobf3d248139b143a2a80e3bb44f90dc11__section_ehn_j4y_vgb"/>

## Run the Graph

In your SAP HANA tenant database, run the following SQL to initialize the schema and tables required by this demo:

```
CREATE SCHEMA STREAMING;
CREATE COLUMN TABLE "STREAMING"."ACTIVITY_HIST"
(	"MACHINEID"		VARCHAR(15),
	"EVENT_TIME"		TIMESTAMP,
	"EVENT_NAME"		VARCHAR(20),
	"EVENT_DESCRIPTION"	VARCHAR(30),
	"EVENT_VALUE"		VARCHAR(30)
);

CREATE COLUMN TABLE "STREAMING"."DASHBOARD"
(	"MACHINEID"		VARCHAR(15) NOT NULL,
	"POWER_STATUS"		VARCHAR(30),
	"CURR_TEMP"		DECIMAL(4,2),
	PRIMARY KEY ("MACHINEID")
 );

CREATE COLUMN TABLE "STREAMING"."MACHINE_REF"
(	"MACHINEID"		VARCHAR(15) NOT NULL,
	 "MACHINETYPE"		VARCHAR(15),
	 "MAX_TEMP"		DECIMAL(4,2),
	 "MIN_TEMP"		DECIMAL(4,2),
	 "LOCATION"		VARCHAR(25),
	 "TEMP_UNIT"		VARCHAR(2),
	 PRIMARY KEY ("MACHINEID")
);

CREATE COLUMN TABLE "STREAMING"."POWER_OUTAGES"
(	"MACHINEID" 		VARCHAR(15),
	"POWER_OFF_TIME" 	LONGDATE,
	"POWER_ON_TIME" 	LONGDATE,
	"DURATION_MIN"		DOUBLE CS_DOUBLE
);

INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '2B','VEND',50,35,'WALG31','F');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '1A','COOL',50,35,'FRI7','F');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '4D','VEND',50,35,'JRB235','F');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '5E','COOL',50,35,'WALG33','F');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '3C','VEND',10,2,'BP762','C');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '6F','FREEZE',32,0,'HIN88','F');
INSERT INTO "STREAMING"."MACHINE_REF"("MACHINEID", "MACHINETYPE", "MAX_TEMP", "MIN_TEMP", "LOCATION", "TEMP_UNIT") VALUES
( '7G','VEND',50,35,'ORD311','F');
```

To clear the data generated by this demo from your tenant database, use the following SQL:

```
delete from STREAMING.ACTIVITY_HIST;
delete from STREAMING.POWER_OUTAGES;
```

