<!-- loio207104a8d47645418962bdb9480166c1 -->

# Pytorch Text Classification

The Pytorch Text Classification Example template illustrates how to use the Training operator to train a supervised learning algorithm for classification using Pytorch, and submit metrics in an ML scenario.



The *Training* operator uses the basic resource plan and a docker image tailored for running TensorFlow on CPUs for the training. The trained model is produced as an artifact via the `TORCHMODEL` output port of the operator. In addition, logs generated by the training script are sent via the logs output port. A Python3 operator *Metrics Extractor* is used to extract metrics from the training logs. The extracted metrics are delivered to the *Submit Metrics* operator, which registers the metrics as part of the scenario.

The *Training* operator outputs the model artifact only after all logs generated during training have been output. When the message representing the model artifact is delivered to the *Workflow Terminator*, the graph will complete.



<a name="loio207104a8d47645418962bdb9480166c1__section_nsl_vyb_vmb"/>

## Configure and Run the Graph

1.  In your ML scenario, choose the *Pipelines* tab.
2.  Click *Create* to add a pipeline.
3.  Enter a name for your pipeline and select the *Pytorch text classification example* template from the dropdown list;
4.  Click *Create*.
5.  Select your pipeline from the list and click *Execute*.



<a name="loio207104a8d47645418962bdb9480166c1__section_vc1_k1c_vmb"/>

## Managing Artifacts in Training

The training script uses the Python SDK `sapdi` to manage artifacts as follows:

```py
import sapdi
from sapdi.artifact import ArtifactKind, ArtifactFileType
```



<a name="loio207104a8d47645418962bdb9480166c1__section_qm2_n1c_vmb"/>

## Creating Artifact for the Trained Model

```py
out_model_artifact = sapdi.create_artifact(
artifact_alias="TORCHMODEL",
file_type=ArtifactFileType.ZIP,
artifact_kind=ArtifactKind.MODEL,
description="Pytorch text classification model",
artifact_name="pytorch_text_classification"
)
model_filename = "model.zip"
model_path = out_model_artifact.get_path()
torch.save(model.state_dict(), model_path+model_filename)
```

